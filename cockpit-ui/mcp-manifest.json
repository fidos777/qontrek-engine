{
  "$schema": "https://modelcontextprotocol.io/schemas/manifest/v1.0.0",
  "name": "qontrek-governance",
  "version": "2.0.0",
  "description": "Qontrek Adaptive Governance Engine - G13-G21 gate scoring and monitoring",
  "author": "Qontrek Team",
  "homepage": "https://github.com/qontrek/qontrek-engine",
  "tools": [
    {
      "name": "computeGovernanceScore",
      "description": "Compute the overall governance score by evaluating all G13-G21 gates. Returns weighted and average scores with detailed gate results.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "tenant_id": {
            "type": "string",
            "description": "Optional tenant identifier for multi-tenant deployments",
            "default": "default"
          },
          "format": {
            "type": "string",
            "enum": ["full", "summary", "health"],
            "description": "Response format: full (all details), summary (condensed), health (quick check)",
            "default": "full"
          }
        },
        "required": []
      },
      "endpoint": "/api/mcp/governance",
      "method": "GET"
    },
    {
      "name": "listGovernanceGates",
      "description": "List all governance gates (G13-G21) with their current status, score, and evidence. Useful for monitoring compliance.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "tenant_id": {
            "type": "string",
            "description": "Optional tenant identifier",
            "default": "default"
          },
          "filter_status": {
            "type": "string",
            "enum": ["all", "pass", "partial", "pending", "fail"],
            "description": "Filter gates by status",
            "default": "all"
          }
        },
        "required": []
      },
      "endpoint": "/api/mcp/governance?format=full",
      "method": "GET"
    },
    {
      "name": "refreshGovernanceScore",
      "description": "Force a refresh of governance scores by re-evaluating all gates. Can optionally persist results to the database.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "tenant_id": {
            "type": "string",
            "description": "Tenant identifier",
            "default": "default"
          },
          "persist": {
            "type": "boolean",
            "description": "Whether to save the computed scores to the database",
            "default": false
          }
        },
        "required": []
      },
      "endpoint": "/api/mcp/governance",
      "method": "POST"
    },
    {
      "name": "getGovernanceHealth",
      "description": "Quick health check for governance status. Returns healthy/unhealthy status and list of critical gates that need attention.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "tenant_id": {
            "type": "string",
            "description": "Optional tenant identifier",
            "default": "default"
          }
        },
        "required": []
      },
      "endpoint": "/api/mcp/governance?format=health",
      "method": "GET"
    },
    {
      "name": "getHealthMetrics",
      "description": "Get health metrics including SLO compliance, panic mode status, anti-replay stats, and key rotation status.",
      "inputSchema": {
        "type": "object",
        "properties": {},
        "required": []
      },
      "endpoint": "/api/mcp/healthz",
      "method": "GET"
    },
    {
      "name": "tailLogs",
      "description": "Tail MCP logs with optional filtering. Returns recent log entries for debugging and monitoring.",
      "inputSchema": {
        "type": "object",
        "properties": {
          "lines": {
            "type": "integer",
            "description": "Number of lines to return (max 1000)",
            "default": 100,
            "minimum": 1,
            "maximum": 1000
          },
          "filter": {
            "type": "string",
            "description": "Optional text filter for log entries"
          }
        },
        "required": []
      },
      "endpoint": "/api/mcp/tail",
      "method": "GET"
    }
  ],
  "resources": [
    {
      "name": "governance-gates",
      "description": "Information about all governance gates G13-G21",
      "uri": "/api/mcp/governance",
      "mimeType": "application/json"
    },
    {
      "name": "health-status",
      "description": "System health status with SLO metrics",
      "uri": "/api/mcp/healthz",
      "mimeType": "application/json"
    }
  ],
  "gates": {
    "G13": {
      "name": "Determinism & Reproducibility",
      "description": "Ensures all cryptographic operations produce consistent, verifiable outputs",
      "weight": 0.12
    },
    "G14": {
      "name": "Privacy by Design",
      "description": "Ensures PII protection, RLS enforcement, and tenant data isolation",
      "weight": 0.15
    },
    "G15": {
      "name": "Federation Correctness",
      "description": "Ensures federation protocol compliance with replay protection and idempotency",
      "weight": 0.12
    },
    "G16": {
      "name": "CI Evidence",
      "description": "Validates CI/CD evidence chain with signed manifests and verification",
      "weight": 0.12
    },
    "G17": {
      "name": "Key Lifecycle",
      "description": "Ensures proper key rotation, registry management, and lifecycle compliance",
      "weight": 0.12
    },
    "G18": {
      "name": "Federation Runtime",
      "description": "Ensures federation runtime stability with durable storage and metrics",
      "weight": 0.10
    },
    "G19": {
      "name": "Ledger Automation",
      "description": "Ensures automated ledger operations with factory seals and CI integration",
      "weight": 0.10
    },
    "G20": {
      "name": "Observatory",
      "description": "Ensures comprehensive observability with health checks and SLO monitoring",
      "weight": 0.10
    },
    "G21": {
      "name": "Genesis Certification",
      "description": "Ensures genesis certification with master closure and tower co-sign",
      "weight": 0.07
    }
  }
}
